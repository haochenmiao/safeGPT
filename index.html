<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>safeGPT</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
  <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet" />
</head>

<body>

  <header>
    <h1>safeGPT</h1>
  </header>

  <main>
    <section class="search">
      <label for="pointA">Point A:</label>
      <input type="text" id="pointA" placeholder="Enter starting point...">

      <label for="pointB">Point B:</label>
      <input type="text" id="pointB" placeholder="Enter destination...">

      <section>
        <button type="text" id="getDirectionsBtn" onclick="getDirections()"> Get Directions </button>
      </section>
    </section>

    <section class="map">
      <!-- Directly include map content -->
      <div id='map'></div>
      <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiY2lsbGFuZ3UiLCJhIjoiY2xwb253Mjd3MHJmcDJqbzl1YTZ0bmtzNyJ9.djwVHU7J_qf1wrGmc2U8mA';
        const map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/streets-v12',
          center: [-122.4194, 37.7749],
          zoom: 10.7
        });
        function getDirections() {
          var pointA = document.getElementById('pointA').value;
          var pointB = document.getElementById('pointB').value;

          // Use Mapbox Geocoding API to get the coordinates for Point A
          fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${pointA}.json?access_token=${mapboxgl.accessToken}`)
            .then(response => response.json())
            .then(data => {
              const locationA = data.features[0].geometry.coordinates;

              // Use Mapbox Geocoding API to get the coordinates for Point B
              fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${pointB}.json?access_token=${mapboxgl.accessToken}`)
                .then(response => response.json())
                .then(data => {
                  const locationB = data.features[0].geometry.coordinates;

                  // Use Mapbox Directions API to get the route between Point A and Point B
                  fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${locationA[0]},${locationA[1]};${locationB[0]},${locationB[1]}?access_token=${mapboxgl.accessToken}`)
                    .then(response => response.json())
                    .then(data => {
                      const routeCoordinates = data.routes[0].geometry.coordinates;
                      console.log('Route Coordinates:', routeCoordinates);

                      // You can use the routeCoordinates for further processing or display on the map
                    })
                    .catch(error => console.error('Error:', error));
                })
                .catch(error => console.error('Error:', error));
            })
            .catch(error => console.error('Error:', error));
        }
      </script>
      <script>
    var directions = new MapboxDirections({
        accessToken: mapboxgl.accessToken,
        unit: 'miles',
        profile: 'mapbox/driving-traffic'
      });
    map.addControl(directions, 'top-left');
      </script>
    </section>

    <section class="chat-box">
      <header class="chatbox_header">Now Chatting</header>
      <div class="chatbox_middle">
          <!-- The middle section where results will be produced -->
      </div>
      <div class="chatbox_input">
          <input type="text" id="chatBox" placeholder="Ask here...">
      </div>
    </section>
  </main>

  <footer>
    <div class="copyright">
      <p>&copy; 2023 safeGPT. All rights reserved.</p>
    </div>

    <div class="name">
      <p>Haochen, Nathan, Haize, Priscilla</p>
    </div>
  </footer>

</body>

</html>
